(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-6b3398c3"],{"08f9":function(e,t,s){"use strict";s.d(t,"e",(function(){return r})),s.d(t,"a",(function(){return i})),s.d(t,"d",(function(){return o})),s.d(t,"b",(function(){return d})),s.d(t,"c",(function(){return n})),s.d(t,"f",(function(){return l}));var a=s("751a");function r(e){return Object(a["a"])({url:"/seckill/api/ordercreate/payment",data:e,forceLogin:!0})}function i(e){return Object(a["a"])({url:"/seckill/api/ordercreate/calculate",data:e,forceLogin:!0})}function o(e){return Object(a["a"])({url:"/seckill/api/ordercreate/create",data:e,forceLogin:!0})}function d(e){return Object(a["a"])({url:"/seckill/api/seckillgoods/page",data:e})}function n(e){return Object(a["a"])({url:"/seckill/api/seckillgoods/detail",data:e})}function l(e){return Object(a["a"])({url:"/seckill/api/seckill/lists",data:e})}},1581:function(e,t,s){"use strict";var a=s("d51e"),r=s.n(a);r.a},2300:function(e,t,s){"use strict";s.r(t);var a=function(){var e=this,t=e.$createElement,s=e._self._c||t;return e.orderCreateData?s("div",{directives:[{name:"loading",rawName:"v-loading",value:e.fullscreenLoading,expression:"fullscreenLoading"}]},[0==e.orderPaymentData.is_virtual?s("div",{staticClass:"item-block"},[s("div",{staticClass:"block-text"},[e._v("收货地址")]),s("div",{attrs:{clsas:"address-list"}},[s("div",{staticClass:"address-item",on:{click:e.addAddressShow}},[e._m(0)]),e._l(e.memberAddress,(function(t,a){return a<3||e.addressShow&&a>=3?s("div",{key:t.id,staticClass:"address-item",class:e.addressId==t.id?"active":""},[s("div",{staticClass:"address-info"},[s("div",{staticClass:"options"},[s("div",{on:{click:function(s){return e.editAddress(t.id)}}},[e._v("编辑")]),0==t.is_default?[s("el-popconfirm",{attrs:{title:"确定要删除该地址吗？"},on:{onConfirm:function(s){return e.deleteMemberAddress(t.id)}}},[s("div",{attrs:{slot:"reference"},slot:"reference"},[e._v("删除")])])]:e._e()],2),s("div",{staticClass:"address-name"},[e._v(e._s(t.name))]),s("div",{staticClass:"address-mobile",on:{click:function(s){return e.setMemberAddress(t.id)}}},[e._v(e._s(t.mobile))]),s("div",{staticClass:"address-desc",on:{click:function(s){return e.setMemberAddress(t.id)}}},[e._v(e._s(t.full_address)+" "+e._s(t.address))])])]):e._e()})),e.memberAddress.length>3&&!e.addressShow?s("div",{staticClass:"el-button--text address-open",on:{click:function(t){e.addressShow=!0}}},[s("i",{staticClass:"el-icon-arrow-down"}),e._v(" 更多收货地址 ")]):e._e(),s("div",{staticClass:"clear"})],2)]):e._e(),1==e.orderPaymentData.is_virtual?s("div",{staticClass:"item-block"},[s("div",{staticClass:"block-text"},[e._v("购买虚拟类商品需填写您的手机号，以方便商家与您联系")]),s("el-form",{ref:"form",staticClass:"mobile-wrap",attrs:{size:"mini","label-width":"80px"}},[s("el-form-item",{attrs:{label:"手机号码"}},[s("el-input",{attrs:{placeholder:"请输入您的手机号码",maxlength:"11"},model:{value:e.orderCreateData.member_address.mobile,callback:function(t){e.$set(e.orderCreateData.member_address,"mobile",t)},expression:"orderCreateData.member_address.mobile"}})],1)],1)],1):e._e(),s("el-dialog",{attrs:{title:0==e.addressForm.id?"添加收货地址":"编辑收货地址",visible:e.dialogVisible,width:"32%"},on:{"update:visible":function(t){e.dialogVisible=t}}},[s("el-form",{ref:"form",attrs:{rules:e.addressRules,model:e.addressForm,"label-width":"80px"}},[s("el-form-item",{attrs:{label:"姓名",prop:"name"}},[s("el-input",{attrs:{placeholder:"收货人姓名"},model:{value:e.addressForm.name,callback:function(t){e.$set(e.addressForm,"name",t)},expression:"addressForm.name"}})],1),s("el-form-item",{attrs:{label:"手机",prop:"mobile"}},[s("el-input",{attrs:{maxlength:"11",placeholder:"收货人手机号"},model:{value:e.addressForm.mobile,callback:function(t){e.$set(e.addressForm,"mobile",t)},expression:"addressForm.mobile"}})],1),s("el-form-item",{attrs:{label:"电话"}},[s("el-input",{attrs:{placeholder:"收货人固定电话（选填）"},model:{value:e.addressForm.telephone,callback:function(t){e.$set(e.addressForm,"telephone",t)},expression:"addressForm.telephone"}})],1),s("el-form-item",{staticClass:"area",attrs:{label:"地区",prop:"area"}},[s("el-row",{attrs:{gutter:10}},[s("el-col",{attrs:{span:7}},[s("el-select",{ref:"province",attrs:{prop:"province",placeholder:"请选择省"},on:{change:function(t){return e.getAddress(1)}},model:{value:e.addressForm.province_id,callback:function(t){e.$set(e.addressForm,"province_id",t)},expression:"addressForm.province_id"}},[s("el-option",{attrs:{label:"请选择省",value:"0"}}),e._l(e.pickerValueArray,(function(e){return s("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})}))],2)],1),s("el-col",{attrs:{span:7}},[s("el-select",{ref:"city",attrs:{prop:"city",placeholder:"请选择市"},on:{change:function(t){return e.getAddress(2)}},model:{value:e.addressForm.city_id,callback:function(t){e.$set(e.addressForm,"city_id",t)},expression:"addressForm.city_id"}},[s("el-option",{attrs:{label:"请选择市",value:"0"}}),e._l(e.cityArr,(function(e){return s("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})}))],2)],1),s("el-col",{attrs:{span:7}},[s("el-select",{ref:"district",attrs:{prop:"district",placeholder:"请选择区/县"},model:{value:e.addressForm.district_id,callback:function(t){e.$set(e.addressForm,"district_id",t)},expression:"addressForm.district_id"}},[s("el-option",{attrs:{label:"请选择区/县",value:"0"}}),e._l(e.districtArr,(function(e){return s("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})}))],2)],1)],1)],1),s("el-form-item",{attrs:{label:"详细地址",prop:"address"}},[s("el-input",{attrs:{placeholder:"定位小区、街道、写字楼"},model:{value:e.addressForm.address,callback:function(t){e.$set(e.addressForm,"address",t)},expression:"addressForm.address"}})],1)],1),s("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[s("el-button",{on:{click:function(t){e.dialogVisible=!1}}},[e._v("取 消")]),s("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.addmemberAddress("form")}}},[e._v("确 定")])],1)],1),e.orderPaymentData.member_account.balance_total>0?s("div",{staticClass:"item-block"},[s("div",{staticClass:"block-text"},[e._v("是否使用余额")]),s("div",{staticClass:"pay-type-list"},[s("div",{staticClass:"pay-type-item",class:e.orderCreateData.is_balance?"":"active",on:{click:function(t){return e.useBalance(0)}}},[e._v("不使用余额")]),s("div",{staticClass:"pay-type-item",class:e.orderCreateData.is_balance?"active":"",on:{click:function(t){return e.useBalance(1)}}},[e._v("使用余额")]),s("div",{staticClass:"clear"})])]):e._e(),e._m(1),s("div",[s("div",{staticClass:"item-block"},[s("div",{staticClass:"goods-list"},[s("table",[s("tr",[s("td",{attrs:{colspan:"5"}},[s("router-link",{attrs:{to:"/shop-"+e.orderPaymentData.shop_goods_list.site_id,target:"_blank"}},[e._v(" "+e._s(e.orderPaymentData.shop_goods_list.site_name)+" ")])],1)])])])]),s("div",{staticClass:"item-block"},[s("div",{staticClass:"goods-list"},[s("table",e._l(e.orderPaymentData.shop_goods_list.goods_list,(function(t,a){return s("tr",{key:a},[s("td",{attrs:{width:"70%"}},[s("div",{staticClass:"goods-info"},[s("div",{staticClass:"goods-info-left"},[s("router-link",{attrs:{to:{path:"/sku-"+t.sku_id},target:"_blank"}},[s("img",{staticClass:"goods-img",attrs:{src:e.$img(t.sku_image,{size:"mid"})},on:{error:function(t){return e.imageError(a)}}})])],1),s("div",{staticClass:"goods-info-right"},[s("router-link",{attrs:{to:{path:"/sku-"+t.sku_id},target:"_blank"}},[s("div",{staticClass:"goods-name"},[e._v(e._s(t.sku_name))])])],1)])]),s("td",{staticClass:"goods-price",attrs:{width:"15%"}},[e._v("￥"+e._s(t.price))]),s("td",{staticClass:"goods-num",attrs:{width:"15%"}},[e._v(e._s(t.num))])])})),0),s("div",{staticClass:"goods-footer"},[s("div",{staticClass:"goods-footer-left"},[0==e.orderPaymentData.is_virtual?s("div",[s("div",{staticClass:"order-cell"},[s("div",{staticClass:"tit"},[e._v(" 配送方式 "),s("span",{staticClass:"ns-text-color"},["store"==e.orderPaymentData.delivery.delivery_type&&e.orderCreateData.delivery.store_name?s("span",[e._v(" "+e._s(e.orderCreateData.delivery.store_name)+" ")]):e._e()])]),e.orderPaymentData.shop_goods_list.express_type.length>0?s("div",e._l(e.orderPaymentData.shop_goods_list.express_type,(function(t,a){return"local"!=t.name?s("div",{key:a,staticClass:"express-item",class:e.orderCreateData.delivery.delivery_type==t.name?"active":"",on:{click:function(s){return e.selectDeliveryType(t)}}},[e._v(" "+e._s(t.title)+" ")]):e._e()})),0):0==e.memberAddress.length?s("div",[s("div",{staticClass:"box ns-text-color"},[e._v("请先添加收货地址")])]):s("div",[s("div",{staticClass:"box ns-text-color"},[e._v("商家未配置配送方式")])])])]):e._e(),s("div",[s("div",{staticClass:"order-cell"},[s("div",{staticClass:"tit"},[e._v("店铺活动")]),s("div",{staticClass:"box text-overflow"},[s("span",{staticClass:"ns-text-color"},[e._v("限时秒杀 "+e._s(e.orderPaymentData.seckill_info.name))])])])])]),s("div",{staticClass:"goods-footer-right"},[s("div",[s("div",{staticClass:"order-cell"},[s("div",{staticClass:"tit"},[e._v("买家留言")]),s("div",{staticClass:"box"},[s("el-input",{staticClass:"buyer-message",attrs:{type:"textarea",placeholder:"留言前建议先与商家协调一致",maxlength:"140","show-word-limit":"",resize:"none"},on:{input:e.textarea},model:{value:e.orderCreateData.buyer_message,callback:function(t){e.$set(e.orderCreateData,"buyer_message",t)},expression:"orderCreateData.buyer_message"}})],1)])])]),s("div",{staticClass:"clear"})])])])]),s("div",{staticClass:"item-block"},[s("div",{staticClass:"order-statistics"},[s("table",[s("tr",[s("td",{attrs:{align:"right"}},[e._v("商品金额：")]),s("td",{attrs:{align:"left"}},[e._v("￥"+e._s(e._f("moneyFormat")(e.orderPaymentData.goods_money)))])]),0==e.orderPaymentData.is_virtual?s("tr",[s("td",{attrs:{align:"right"}},[e._v("运费：")]),s("td",{attrs:{align:"left"}},[e._v("￥"+e._s(e._f("moneyFormat")(e.orderPaymentData.delivery_money)))])]):e._e(),e.orderPaymentData.invoice_money>0?s("tr",[s("td",{attrs:{align:"right"}},[e._v("税费：")]),s("td",{attrs:{align:"left"}},[e._v("￥"+e._s(e._f("moneyFormat")(e.orderPaymentData.invoice_money)))])]):e._e(),e.orderPaymentData.promotion_money>0?s("tr",[s("td",{attrs:{align:"right"}},[e._v("优惠：")]),s("td",{attrs:{align:"left"}},[e._v("￥"+e._s(e._f("moneyFormat")(e.orderPaymentData.promotion_money)))])]):e._e(),e.orderPaymentData.balance_money>0?s("tr",[s("td",{attrs:{align:"right"}},[e._v("使用余额：")]),s("td",{attrs:{align:"left"}},[e._v("￥"+e._s(e._f("moneyFormat")(e.orderPaymentData.balance_money)))])]):e._e()])]),s("div",{staticClass:"clear"})]),s("div",{staticClass:"item-block"},[s("div",{staticClass:"order-submit"},[s("div",{staticClass:"order-money"},[e._v(" 共"+e._s(e.orderPaymentData.goods_num)+"件，应付金额： "),s("div",{staticClass:"ns-text-color"},[e._v("￥"+e._s(e._f("moneyFormat")(e.orderPaymentData.pay_money)))])]),s("el-button",{staticClass:"el-button--primary",attrs:{type:"primary"},on:{click:e.orderCreate}},[e._v("订单结算")])],1),s("div",{staticClass:"clear"})]),s("el-dialog",{attrs:{title:"选择门店",visible:e.dialogStore,width:"50%"},on:{"update:visible":function(t){e.dialogStore=t}}},[s("el-table",{ref:"singleTable",staticClass:"cursor-pointer",attrs:{data:e.storeList,"highlight-current-row":""},on:{"row-click":e.selectStore}},[s("el-table-column",{attrs:{label:"",width:"55"},scopedSlots:e._u([{key:"default",fn:function(t){return[s("el-radio",{attrs:{label:t.row},model:{value:e.storeRadio,callback:function(t){e.storeRadio=t},expression:"storeRadio"}},[s("i")])]}}],null,!1,3524537448)}),s("el-table-column",{attrs:{prop:"store_name",label:"名称",width:"160"}}),s("el-table-column",{attrs:{prop:"store_address",label:"地址"}}),s("el-table-column",{attrs:{prop:"open_date",label:"营业时间"}})],1)],1),s("el-dialog",{attrs:{title:"送达时间",visible:e.deliveryTime,width:"400px"},on:{"update:visible":function(t){e.deliveryTime=t}}},[s("el-form",{ref:"ruleForm",attrs:{"status-icon":"","label-width":"100px"}},[s("el-form-item",{attrs:{label:"送达时间"}},[s("el-col",{attrs:{span:11}},[s("el-time-picker",{attrs:{format:"HH:mm","value-format":"HH:mm",placeholder:"选择时间",value:e.time,start:"09:01",end:"21:01"},on:{change:e.bindTimeChange},model:{value:e.time,callback:function(t){e.time=t},expression:"time"}})],1)],1),s("el-form-item",{attrs:{label:""}},[s("el-col",{attrs:{span:20}},[s("div",{staticClass:"align-right"},[s("el-button",{attrs:{size:"small"},on:{click:function(t){e.deliveryTime=!1}}},[e._v("关闭")]),s("el-button",{attrs:{type:"primary",size:"small"},on:{click:function(t){return e.setDeliveryTime(e.siteDelivery.site_id)}}},[e._v("确认选择")])],1)])],1)],1)],1),s("el-dialog",{attrs:{title:"使用余额",visible:e.dialogpay,width:"350px"},on:{"update:visible":function(t){e.dialogpay=t}}},[0==e.orderPaymentData.member_account.is_pay_password?[s("p",[e._v("为了您的账户安全,请您先设置的支付密码")]),s("p",[e._v('可到"会员中心","账号安全","支付密码"中设置')]),s("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[s("el-button",{attrs:{size:"small"},on:{click:function(t){e.dialogpay=!1}}},[e._v("暂不设置")]),s("el-button",{attrs:{size:"small",type:"primary"},on:{click:e.setPayPassword}},[e._v("立即设置")])],1)]:s("el-form",{ref:"ruleForm",attrs:{"status-icon":"","label-width":"100px"}},[s("el-form-item",{staticClass:"pay-password-item",attrs:{label:"支付密码"}},[s("el-input",{staticClass:"pay-password hide-password",attrs:{type:"password",maxlength:6}}),s("el-input",{staticClass:"pay-password",attrs:{type:"password",maxlength:6},on:{input:e.input},model:{value:e.password,callback:function(t){e.password=t},expression:"password"}})],1),s("p",{staticClass:"ns-text-color forget-password",on:{click:e.setPayPassword}},[e._v("忘记密码")])],1)],2)],1):e._e()},r=[function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"add-address"},[s("i",{staticClass:"el-icon-circle-plus-outline"}),e._v(" 添加收货地址 ")])},function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"item-block"},[s("div",{staticClass:"goods-list"},[s("table",[s("tr",[s("td",{attrs:{width:"70%"}},[e._v("商品")]),s("td",{attrs:{width:"15%"}},[e._v("价格")]),s("td",{attrs:{width:"15%"}},[e._v("数量")])])])])])}],i=s("86bd"),o=(s("4160"),s("b0c0"),s("b680"),s("b64b"),s("d3b7"),s("25f0"),s("159b"),s("5530")),d=s("b090"),n=s("69f9"),l=s("08f9"),c=s("2f94"),m=s("2f62"),u={name:"seckill_payment",components:{},data:function(){var e=function(e,t,s){""===t?s(new Error("请输入手机号")):/^1[3|4|5|6|7|8|9][0-9]{9}$/.test(t)?s():s(new Error("手机号格式错误"))};return{dialogVisible:!1,memberAddress:{},addressId:0,addressForm:{id:0,name:"",mobile:"",telephone:"",province_id:"",city_id:"",district_id:"",community_id:"",address:"",full_address:"",is_default:"",longitude:"",latitude:""},pickerValueArray:{},cityArr:{},districtArr:{},addressRules:{name:[{required:!0,message:"请输入收货人",trigger:"blur"},{min:1,max:20,message:"长度在 1 到 20 个字符",trigger:"blur"}],mobile:[{required:!0,validator:e,trigger:"change"}],province:[{required:!0,message:"请选择省",trigger:"change"}],city:[{required:!0,message:"请选择市",trigger:"change"}],district:[{required:!0,message:"请选择区/县",trigger:"change"}],address:[{required:!0,message:"请输入详细地址",trigger:"change"}]},isSend:!1,orderCreateData:{is_balance:0,pay_password:""},orderPaymentData:{goods_money:0,pay_money:0,shop_goods_list:{site_name:"",express_type:[],coupon_list:[]},seckill_info:{name:""},member_account:{balance:0,is_pay_password:0}},siteCoupon:{site_id:0,data:[]},siteDelivery:{site_id:0,data:[]},dialogStore:!1,promotionInfo:!1,storeList:{},sitePromotion:[],isSub:!1,dialogpay:!1,password:"",fullscreenLoading:!0,deliveryTime:!1,timeTip:"选择配送时间",time:null,addressShow:!1,storeRadio:!1}},computed:Object(o["a"])({},Object(m["b"])(["seckillOrderCreateData","defaultGoodsImage","city"])),mounted:function(){},created:function(){this.getMemberAddress(),this.getOrderPaymentData()},filters:{moneyFormat:function(e){return parseFloat(e).toFixed(2)},promotion:function(e){var t="";return e&&Object.keys(e).forEach((function(s){t+=e[s].content+"　"})),t}},methods:{getMemberAddress:function(){var e=this;Object(n["e"])({page_size:0}).then((function(t){t.code,t.message;var s=t.data;if(s&&s.list){var a=e;e.memberAddress=s.list,s.list.forEach((function(e){1==e.is_default&&(a.addressId=e.id)}))}})).catch((function(t){t.code;var s=t.message;t.data;e.$message.error(s)}))},setMemberAddress:function(e){var t=this;this.addressId=e,Object(n["n"])({id:e}).then((function(e){e.code,e.message,e.data;t.orderCalculate()})).catch((function(e){e.code;var s=e.message;e.data;t.$message.error(s)}))},deleteMemberAddress:function(e){var t=this;Object(n["i"])({id:e}).then((function(e){e.code;var s=e.message,a=e.data;a?(t.$message({message:s,type:"success"}),t.getMemberAddress()):t.$message({message:s,type:"warning"})})).catch((function(e){t.$message.error(e.message)}))},addAddressShow:function(){var e=this;this.dialogVisible=!0,this.addressForm.id=0,this.addressForm.name="",this.addressForm.mobile="",this.addressForm.telephone="",this.addressForm.province_id="",this.addressForm.city_id="",this.addressForm.district_id="",this.addressForm.community_id="",this.addressForm.address="",this.addressForm.full_address="",this.addressForm.is_default="",this.addressForm.longitude="",this.addressForm.latitude="",this.$nextTick((function(){e.$refs.form.resetFields()})),this.cityArr={},this.districtArr={},this.getAddress(0)},getAddress:function(e){var t=this,s=0,a=this;switch(e){case 0:s=0;break;case 1:s=this.addressForm.province_id,a.cityArr={},a.districtArr={},this.addressForm.city_id="",this.addressForm.district_id="";break;case 2:s=this.addressForm.city_id,a.districtArr={},this.addressForm.district_id="";break}Object(c["a"])({pid:s}).then((function(t){t.code,t.message;var s=t.data;if(s)switch(e){case 0:a.pickerValueArray=s;break;case 1:a.cityArr=s;break;case 2:a.districtArr=s;break}})).catch((function(e){e.code;var s=e.message;e.data;t.$message.error(s)}))},initAddress:function(e){var t=this,s=0,a=this;switch(e){case 0:s=0;break;case 1:s=this.addressForm.province_id,a.cityArr={},a.districtArr={};break;case 2:s=this.addressForm.city_id,a.districtArr={};break}Object(c["a"])({pid:s}).then((function(t){t.code,t.message;var s=t.data;if(s)switch(e){case 0:a.pickerValueArray=s;break;case 1:a.cityArr=s;break;case 2:a.districtArr=s;break}})).catch((function(e){e.code;var s=e.message;e.data;t.$message.error(s)}))},saveAddress:function(e){var t=this;this.$refs[e].validate((function(e){if(!e)return!1;if(t.isSend)return!1;if(t.addressForm.id){t.addressForm.full_address=t.$refs.province.selectedLabel+"-"+t.$refs.city.selectedLabel+"-"+t.$refs.district.selectedLabel;var s=t.addressForm;if(!s.province_id)return t.$message({message:"请选择省",type:"warning"}),!1;if(!s.city_id)return t.$message({message:"请选择市",type:"warning"}),!1;if(!s.district_id)return t.$message({message:"请选择区/县",type:"warning"}),!1;t.isSend=!0,t.setMemberAddress(s.id),s.url="edit",Object(n["m"])(s).then((function(e){e.code;var s=e.message,a=e.data;a?(t.$message({message:s,type:"success"}),t.dialogVisible=!1,t.getMemberAddress(),t.getOrderPaymentData()):t.$message({message:s,type:"warning"}),t.isSend=!1})).catch((function(e){e.code;var s=e.message;e.data;t.$message.error(s)}))}else{t.addressForm.full_address=t.$refs.province.selectedLabel+"-"+t.$refs.city.selectedLabel+"-"+t.$refs.district.selectedLabel;var a={name:t.addressForm.name,mobile:t.addressForm.mobile,telephone:t.addressForm.telephone,province_id:t.addressForm.province_id,city_id:t.addressForm.city_id,district_id:t.addressForm.district_id,community_id:"",address:t.addressForm.address,full_address:t.addressForm.full_address,longitude:t.addressForm.longitude,latitude:t.addressForm.latitude,is_default:t.addressForm.is_default,url:"add"};if(!a.province_id)return t.$message({message:"请选择省",type:"warning"}),!1;if(!a.city_id)return t.$message({message:"请选择市",type:"warning"}),!1;if(!a.district_id)return t.$message({message:"请选择区/县",type:"warning"}),!1;t.isSend=!0,addMemberAddress(a).then((function(e){e.code;var s=e.message,a=e.data;a?(t.setMemberAddress(a),t.$message({message:s,type:"success"}),t.dialogVisible=!1,t.getMemberAddress(),t.getOrderPaymentData()):t.$message({message:s,type:"warning"}),t.isSend=!1})).catch((function(e){e.code;var s=e.message;e.data;t.$message.error(s)}))}}))},editAddress:function(e){var t=this;Object(n["d"])({id:e}).then((function(e){e.code,e.message;var s=e.data;t.addressForm={id:s.id,name:s.name,mobile:s.mobile,telephone:s.telephone,province_id:s.province_id,city_id:"",district_id:"",community_id:"",address:s.address,full_address:s.full_address,is_default:s.is_default,longitude:s.longitude,latitude:s.latitude},t.initAddress(0),t.initAddress(1),t.addressForm.city_id=s.city_id,t.initAddress(2),t.addressForm.district_id=s.district_id,t.dialogVisible=!0})).catch((function(e){e.code;var s=e.message;e.data;t.$message.error(s)}))},getOrderPaymentData:function(){var e=this;this.orderCreateData=this.seckillOrderCreateData,this.orderCreateData?(this.orderCreateData.web_city=this.city?this.city.id:0,Object(l["e"])(this.orderCreateData).then((function(t){var s=t.code;t.message,t.data;s>=0?(e.orderPaymentData=t.data,e.handlePaymentData()):e.$message({message:"未获取到创建订单所需数据！",type:"warning",offset:225,duration:3e3,onClose:function(){return e.$router.go(-1),!1}})})).catch((function(t){t.code;var s=t.message;t.data;e.$message.error(s)}))):this.$message({message:"未获取到创建订单所需数据！",type:"warning",offset:225,duration:3e3,onClose:function(){return e.$router.go(-1),!1}})},handlePaymentData:function(){this.orderCreateData.delivery={},this.orderCreateData.coupon={},this.orderCreateData.is_balance=0,this.orderCreateData.pay_password="";var e=this.orderPaymentData,t=(new Date).getHours().toString(),s=(new Date).getMinutes().toString();1==t.length&&(t="0"+t),1==s.length&&(s="0"+s);var a=t+":"+s;if(e.shop_goods_list.local_config&&(e.shop_goods_list.local_config.info&&1==e.shop_goods_list.local_config.info.time_is_open?(this.orderCreateData.delivery.showTimeBar=!0,this.orderCreateData.delivery.buyer_ask_delivery_time=a):this.orderCreateData.delivery.showTimeBar=!1),void 0!=e.shop_goods_list.express_type&&void 0!=e.shop_goods_list.express_type[0]){var r=e.shop_goods_list.express_type;this.orderCreateData.delivery.delivery_type=r[0].name,this.orderCreateData.delivery.delivery_type_name=r[0].title,this.orderCreateData.delivery.store_id=0,"store"==r[0].name&&void 0!=r[0].store_list[0]&&(this.orderCreateData.delivery.store_id=r[0].store_list[0].store_id)}if(void 0!=e.shop_goods_list.coupon_list&&void 0!=e.shop_goods_list.coupon_list[0]){var i=e.shop_goods_list.coupon_list;this.orderCreateData.coupon.coupon_id=i[0].coupon_id,this.orderCreateData.coupon.coupon_money=i[0].money}this.orderPaymentData.is_virtual&&(this.orderCreateData.member_address={mobile:""}),Object.assign(this.orderPaymentData,this.orderCreateData),this.orderCalculate()},orderCalculate:function(){var e=this;this.fullscreenLoading=!0;var t=this.orderPaymentData.shop_goods_list.site_id,s={};s[t]=this.orderCreateData.delivery;var a={};a[t]=this.orderCreateData.buyer_message;var r=this.$util.deepClone(this.orderCreateData);r.delivery=JSON.stringify(s),r.buyer_message=JSON.stringify(a),r.member_address=JSON.stringify(r.member_address),Object(l["a"])(r).then((function(t){var s=t.code,a=t.message;t.data;s>=0?(e.orderPaymentData.delivery_money=t.data.delivery_money,e.orderPaymentData.coupon_money=t.data.coupon_money,e.orderPaymentData.invoice_money=t.data.invoice_money,e.orderPaymentData.promotion_money=t.data.promotion_money,e.orderPaymentData.order_money=t.data.order_money,e.orderPaymentData.balance_money=t.data.balance_money,e.orderPaymentData.pay_money=t.data.pay_money,e.orderPaymentData.goods_money=t.data.goods_money,e.fullscreenLoading=!1):e.$message({message:a,type:"warning",offset:225,duration:3e3,onClose:function(){return e.$router.go(-1),!1}})})).catch((function(t){t.code;var s=t.message;t.data;e.$message.error(s),e.fullscreenLoading=!1}))},selectDeliveryType:function(e){this.orderCreateData.delivery.delivery_type=e.name,this.orderCreateData.delivery.delivery_type_name=e.title,"store"==e.name?(e.store_list.forEach((function(t,s){e.store_list[s]["store_address"]=t.full_address+t.address})),void 0!=e.store_list[0]&&(this.orderCreateData.delivery.store_id=e.store_list[0].store_id),this.dialogStore=!0,this.storeList=e.store_list):"local"==e.name&&(this.deliveryTime=!0),Object.assign(this.orderPaymentData,this.orderCreateData),this.orderCalculate(),this.$forceUpdate()},selectStore:function(e){if(e){var t=e.store_id;this.dialogStore=!1,this.orderCreateData.delivery[this.siteDelivery.site_id].store_id=t,this.orderCreateData.delivery[this.siteDelivery.site_id].store_name=e.store_name,Object.assign(this.orderPaymentData,this.orderCreateData),this.storeRadio=e,this.orderCalculate(),this.$forceUpdate()}},openSitePromotion:function(e){this.sitePromotion=e,this.promotionInfo?this.promotionInfo=!1:this.promotionInfo=!0},useBalance:function(e){this.orderCreateData.is_balance?this.orderCreateData.is_balance=0:this.orderCreateData.is_balance=1,this.orderCalculate(),this.$forceUpdate()},orderCreate:function(){var e=this;if(this.verify()){if(this.isSub)return;this.isSub=!0;var t=this.$loading({lock:!0,text:"订单提交中...",spinner:"el-icon-loading",background:"rgba(0, 0, 0, 0.7)"}),s=this.orderPaymentData.shop_goods_list.site_id,a={};a[s]=this.orderCreateData.delivery;var r={};r[s]=this.orderCreateData.buyer_message;var i=this.$util.deepClone(this.orderCreateData);i.delivery=JSON.stringify(a),i.buyer_message=JSON.stringify(r),i.member_address=JSON.stringify(i.member_address),Object(l["d"])(i).then((function(s){var a=s.code,r=s.message,i=s.data;t.close(),a>=0?(e.$store.dispatch("order/removeSeckillOrderCreateData",""),0==e.orderPaymentData.pay_money?e.$router.push({path:"/result",query:{code:i}}):e.$router.push({path:"/pay",query:{code:i}})):e.$message({message:r,type:"warning"})})).catch((function(s){t.close(),e.isSub=!1;s.code;var a=s.message;s.data;e.$message.error(a)}))}},verify:function(){if(1==this.orderPaymentData.is_virtual){if(!this.orderCreateData.member_address.mobile.length)return this.$message({message:"请输入您的手机号码",type:"warning"}),!1;var e=/^[1](([3][0-9])|([4][5-9])|([5][0-3,5-9])|([6][5,6])|([7][0-8])|([8][0-9])|([9][1,8,9]))[0-9]{8}$/;if(!e.test(this.orderCreateData.member_address.mobile))return this.$message({message:"请输入正确的手机号码",type:"warning"}),!1}if(0==this.orderPaymentData.is_virtual){if(!this.orderPaymentData.member_address)return this.$message({message:"请先选择您的收货地址",type:"warning"}),!1;var t=!0;for(var s in this.orderCreateData.delivery){if("{}"==JSON.stringify(this.orderCreateData.delivery[s])){t=!1,this.$message({message:'店铺"'+this.orderPaymentData.shop_goods_list[s].site_name+'"未设置配送方式',type:"warning"});break}if("store"==this.orderCreateData.delivery[s].delivery_type&&0==this.orderCreateData.delivery[s].store_id){t=!1,this.$message({message:'店铺"'+this.orderPaymentData.shop_goods_list[s].site_name+'"没有可提货的门店,请选择其他配送方式',type:"warning"});break}}if(!t)return!1}return 1!=this.orderCreateData.is_balance||""!=this.orderCreateData.pay_password||(this.dialogpay=!0,!1)},input:function(){var e=this;if(6==this.password.length){var t=this.$loading({lock:!0,text:"支付中",spinner:"el-icon-loading",background:"rgba(0, 0, 0, 0.7)"});Object(d["b"])({pay_password:this.password}).then((function(s){var a=s.code,r=s.message;s.data;t.close(),a>=0?(e.orderCreateData.pay_password=e.password,e.orderCreate(),e.dialogpay=!1):e.$message.error(r)})).catch((function(s){t.close();s.code;var a=s.message;s.data;e.$message.error(a)}))}},textarea:function(){this.$forceUpdate()},bindTimeChange:function(e){this.time=e,this.orderCreateData.delivery.buyer_ask_delivery_time=this.time},setDeliveryTime:function(){this.deliveryTime=!1,this.orderCreateData.delivery.buyer_ask_delivery_time=this.time},imageError:function(e){this.orderPaymentData.shop_goods_list.goods_list[e].sku_image=this.defaultGoodsImage},setPayPassword:function(){this.$router.pushToTab("/member/security")}}},h={name:"seckill_payment",components:{PicZoom:i["a"]},mixins:[u]},g=h,f=(s("beb5"),s("2877")),p=Object(f["a"])(g,a,r,!1,null,"79b08b03",null);t["default"]=p.exports},"31a6":function(e,t,s){},5899:function(e,t){e.exports="\t\n\v\f\r                　\u2028\u2029\ufeff"},"58a8":function(e,t,s){var a=s("1d80"),r=s("5899"),i="["+r+"]",o=RegExp("^"+i+i+"*"),d=RegExp(i+i+"*$"),n=function(e){return function(t){var s=String(a(t));return 1&e&&(s=s.replace(o,"")),2&e&&(s=s.replace(d,"")),s}};e.exports={start:n(1),end:n(2),trim:n(3)}},"86bd":function(e,t,s){"use strict";var a=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{ref:e.id,staticClass:"magnifier-box",class:e.vertical?"vertical":"",on:{mousemove:e.mousemove,mouseover:e.mouseover,mouseleave:e.mouseleave}},[s("img",{directives:[{name:"show",rawName:"v-show",value:e.showImg,expression:"showImg"}],attrs:{src:e.imgUrl,alt:""}}),s("div",{staticClass:"mouse-cover"}),e.showEidt?s("div",{staticClass:"edit-wrap"},[s("span",{staticClass:"rotate-left",on:{click:function(t){return e.rotate("left")}}}),s("span",{staticClass:"rotate-right",on:{click:function(t){return e.rotate("right")}}})]):e._e()])},r=[],i=(s("c975"),s("a9e3"),s("d3b7"),s("25f0"),{props:{scale:{type:Number,default:2.5},url:{type:String,required:!0},bigUrl:{type:String,default:null},scroll:{type:Boolean,default:!1},showEidt:{type:Boolean,default:!1}},data:function(){return{id:null,cover:null,imgbox:null,imgwrap:null,orginUrl:null,bigImgUrl:null,bigOrginUrl:null,imgUrl:null,img:null,canvas:null,ctx:null,rectTimesX:0,rectTimesY:0,imgTimesX:0,imgTimesY:0,init:!1,step:0,bigStep:0,vertical:!1,showImg:!0}},created:function(){for(var e="ABCDEFGHJKMNPQRSTWXYZabcdefhijkmnprstwxyz2345678",t=e.length,s="",a=0;a<10;a++)s+=e.charAt(Math.floor(Math.random()*t));this.id=s,this.imgUrl=this.url,this.orginUrl=this.url,this.bigImgUrl=this.bigUrl,this.bigOrginUrl=this.bigUrl},watch:{url:function(e){this.imgUrl=e,this.orginUrl=e,this.initTime()},bigUrl:function(e){function t(){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}((function(){this.bigImgUrl=bigUrl,this.bigOrginUrl=bigUrl,this.initTime()}))},mounted:function(){var e=this;this.$nextTick((function(){e.initTime()}))},methods:{initTime:function(){var e=this;this.init=!1;var t,s=this.$refs[this.id];this.imgbox=s,this.cover=s.querySelector(".mouse-cover"),this.cover.style.width=this.imgbox.offsetWidth/this.scale+"px",this.cover.style.height=this.imgbox.offsetHeight/this.scale+"px",this.cover.style.left="-100%",this.cover.style.top="-100%",this.imgwrap=s.querySelector("img"),t=this.bigImgUrl?this.bigImgUrl:this.imgUrl,this.img=new Image,this.img.src=t,this.img.onload=function(){e.rectTimesX=e.imgbox.offsetWidth/e.scale/e.imgwrap.offsetWidth,e.rectTimesY=e.imgbox.offsetHeight/e.scale/e.imgwrap.offsetHeight,e.imgTimesX=e.img.width/e.imgwrap.offsetWidth,e.imgTimesY=e.img.height/e.imgwrap.offsetHeight,e.vertical=e.img.width<e.img.height,e.init=!0},this.canvas&&(this.canvas.parentNode.removeChild(this.canvas),this.canvas=null),this.canvas=document.createElement("canvas"),this.canvas.className="mouse-cover-canvas",this.canvas.style.position="absolute",this.canvas.style.left=this.imgbox.offsetLeft+this.imgbox.offsetWidth+10+"px",this.canvas.style.top=this.imgbox.offsetTop+"px",this.canvas.style.border="1px solid #eee",this.canvas.style.zIndex="99999",this.canvas.height=this.imgbox.offsetHeight,this.canvas.width=this.imgbox.offsetWidth,this.canvas.style.display="none",document.body.append(this.canvas),this.ctx=this.canvas.getContext("2d"),this.ctx.clearRect(0,0,this.canvas.width,this.canvas.height)},initBox:function(){var e=this;this.showImg=!1,this.canvas.style.display="none";var t,s=this.$refs[this.id];t=this.bigImgUrl?this.bigImgUrl:this.imgUrl,this.img=new Image,this.img.src=t,this.img.onload=function(){e.vertical=e.img.width<e.img.height,e.showImg=!0;s.querySelector("img");setTimeout((function(){e.rectTimesX=e.imgbox.offsetWidth/e.scale/s.querySelector("img").offsetWidth,e.rectTimesY=e.imgbox.offsetHeight/e.scale/s.querySelector("img").offsetHeight}),20)}},mousemove:function(e){if(!this.init)return!1;var t=this;function s(e){var t=null,s=null,a=e.offsetParent;t+=e.offsetLeft,s+=e.offsetTop;while(a)-1===navigator.userAgent.indexOf("MSIE 8.0")&&(t+=a.clientLeft,s+=a.clientTop),t+=a.offsetLeft,s+=a.offsetTop,a=a.offsetParent;return{left:t,top:s}}function a(e){return{x:e.clientX-t.cover.offsetWidth/2,y:e.clientY-t.cover.offsetHeight/2}}var r=e||event,i=a(r),o=s(this.imgwrap),d={minX:o.left,maxX:o.left+this.imgwrap.offsetWidth-this.cover.offsetWidth,minY:o.top-document.documentElement.scrollTop,maxY:o.top-document.documentElement.scrollTop+this.imgwrap.offsetHeight-this.cover.offsetHeight};i.x>d.maxX&&(i.x=d.maxX),i.x<d.minX&&(i.x=d.minX),i.y>d.maxY&&(i.y=d.maxY),i.y<d.minY&&(i.y=d.minY),this.cover.style.left=i.x+"px",this.cover.style.top=i.y+"px",this.ctx.clearRect(0,0,this.imgwrap.offsetWidth,this.imgwrap.offsetHeight);var n=i.x-(o.left-document.documentElement.scrollLeft),l=i.y-(o.top-document.documentElement.scrollTop);this.ctx.drawImage(this.img,n*this.imgTimesX,l*this.imgTimesY,this.img.width*this.rectTimesX,this.img.height*this.rectTimesY,0,0,this.imgbox.offsetWidth,this.imgbox.offsetHeight)},mouseover:function(e){if(!this.init)return!1;e=e||event,this.scroll||(e.currentTarget.addEventListener("mousewheel",(function(e){e.preventDefault()}),!1),e.currentTarget.addEventListener("DOMMouseScroll",(function(e){e.preventDefault()}),!1)),this.cover.style.display="block",this.canvas.style.display="block"},mouseleave:function(){if(!this.init)return!1;this.cover.style.display="none",this.canvas.style.display="none"},rotate:function(e){var t=this,s=new Image;if(s.crossOrigin="Anonymous",s.src=this.orginUrl,s.onload=function(){t.rotateImg(s,e,t.step)},this.bigOrginUrl){var a=new Image;s.crossOrigin="Anonymous",a.src=this.bigOrginUrl,a.onload=function(){t.rotateImg(a,e,t.bigStep,!0)}}},rotateImg:function(e,t,s){var a=this,r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],i=0,o=3;if(null!=e){var d=e.height,n=e.width;null==s&&(s=i),"right"==t?(s++,s>o&&(s=i)):(s--,s<i&&(s=o));var l=document.createElement("canvas"),c=90*s*Math.PI/180,m=l.getContext("2d");switch(l.width=d,l.height=n,m.rotate(c),m.drawImage(e,0,-d),s){case 0:l.width=n,l.height=d,m.drawImage(e,0,0);break;case 1:l.width=d,l.height=n,m.rotate(c),m.drawImage(e,0,-d);break;case 2:l.width=n,l.height=d,m.rotate(c),m.drawImage(e,-n,-d);break;case 3:l.width=d,l.height=n,m.rotate(c),m.drawImage(e,-n,0);break}var u=l.toDataURL();r?(this.bigImgUrl=u,this.bigStep=s,this.initBox()):(this.imgUrl=u,this.step=s,this.$nextTick((function(){a.initBox()})))}}}}),o=i,d=(s("1581"),s("2877")),n=Object(d["a"])(o,a,r,!1,null,"f9b02836",null);t["a"]=n.exports},a9e3:function(e,t,s){"use strict";var a=s("83ab"),r=s("da84"),i=s("94ca"),o=s("6eeb"),d=s("5135"),n=s("c6b6"),l=s("7156"),c=s("c04e"),m=s("d039"),u=s("7c73"),h=s("241c").f,g=s("06cf").f,f=s("9bf2").f,p=s("58a8").trim,v="Number",_=r[v],y=_.prototype,b=n(u(y))==v,C=function(e){var t,s,a,r,i,o,d,n,l=c(e,!1);if("string"==typeof l&&l.length>2)if(l=p(l),t=l.charCodeAt(0),43===t||45===t){if(s=l.charCodeAt(2),88===s||120===s)return NaN}else if(48===t){switch(l.charCodeAt(1)){case 66:case 98:a=2,r=49;break;case 79:case 111:a=8,r=55;break;default:return+l}for(i=l.slice(2),o=i.length,d=0;d<o;d++)if(n=i.charCodeAt(d),n<48||n>r)return NaN;return parseInt(i,a)}return+l};if(i(v,!_(" 0o1")||!_("0b1")||_("+0x1"))){for(var w,D=function(e){var t=arguments.length<1?0:e,s=this;return s instanceof D&&(b?m((function(){y.valueOf.call(s)})):n(s)!=v)?l(new _(C(t)),s,D):C(t)},k=a?h(_):"MAX_VALUE,MIN_VALUE,NaN,NEGATIVE_INFINITY,POSITIVE_INFINITY,EPSILON,isFinite,isInteger,isNaN,isSafeInteger,MAX_SAFE_INTEGER,MIN_SAFE_INTEGER,parseFloat,parseInt,isInteger".split(","),x=0;k.length>x;x++)d(_,w=k[x])&&!d(D,w)&&f(D,w,g(_,w));D.prototype=y,y.constructor=D,o(r,v,D)}},b090:function(e,t,s){"use strict";s.d(t,"d",(function(){return r})),s.d(t,"a",(function(){return i})),s.d(t,"c",(function(){return o})),s.d(t,"b",(function(){return d}));var a=s("751a");function r(e){return Object(a["a"])({url:"/api/ordercreate/payment",data:e,forceLogin:!0})}function i(e){return Object(a["a"])({url:"/api/ordercreate/calculate",data:e,forceLogin:!0})}function o(e){return Object(a["a"])({url:"/api/ordercreate/create",data:e,forceLogin:!0})}function d(e){return Object(a["a"])({url:"/api/member/checkpaypassword",data:e,forceLogin:!0})}},beb5:function(e,t,s){"use strict";var a=s("31a6"),r=s.n(a);r.a},d51e:function(e,t,s){}}]);
//# sourceMappingURL=chunk-6b3398c3.0c791e21.js.map