(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-4e084ad9"],{"3e0f":function(t,a,e){"use strict";e.d(a,"b",(function(){return s})),e.d(a,"c",(function(){return n})),e.d(a,"a",(function(){return o})),e.d(a,"d",(function(){return r}));var i=e("751a");function s(t){return Object(i["a"])({url:"/api/pay/info",data:t,forceLogin:!0})}function n(t){return Object(i["a"])({url:"/api/pay/type",data:t,forceLogin:!0})}function o(t){return Object(i["a"])({url:"/api/pay/status",data:t,forceLogin:!0})}function r(t){return Object(i["a"])({url:"/api/pay/pay",data:t,forceLogin:!0})}},"7bb3":function(t,a,e){"use strict";e.r(a);var i=function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("div",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}]},[e("div",{staticClass:"item-block"},[e("div",{staticClass:"payment-detail"},[e("div",{staticClass:"payment-media"},[e("el-row",[e("el-col",{attrs:{span:4}},[e("div",{staticClass:"media-left"},[e("i",{staticClass:"el-icon-circle-check ns-text-color"})])]),e("el-col",{attrs:{span:16}},[e("div",{staticClass:"media-body"},[e("el-row",[e("el-col",{attrs:{span:12}},[e("div",{staticClass:"payment-text"},[t._v("您的订单已提交成功，正在等待处理！")]),e("div",[e("span",[t._v("应付金额：")]),e("span",{staticClass:"payment-money ns-text-color"},[t._v("￥"+t._s(t.payInfo.pay_money)+"元")])])]),e("el-col",{attrs:{span:12}})],1)],1)]),e("el-col",{attrs:{span:4}},[e("div",{staticClass:"media-right"},[e("div",{staticClass:"el-button--text",on:{click:function(a){t.orderOpen?t.orderOpen=!1:t.orderOpen=!0}}},[t._v(" 订单信息 "),e("i",{staticClass:"el-icon-arrow-down",class:t.orderOpen?"rotate":""})])])])],1)],1),t.orderOpen?e("div",{staticClass:"order-info"},[e("el-row",[e("el-col",{staticClass:"order-info-left",attrs:{span:4}}),e("el-col",{attrs:{span:20}},[e("div",{staticClass:"line"}),e("div",{staticClass:"order-item"},[e("div",{staticClass:"item-label"},[t._v("交易单号：")]),e("div",{staticClass:"item-value"},[t._v(t._s(t.payInfo.out_trade_no))])]),e("div",{staticClass:"order-item"},[e("div",{staticClass:"item-label"},[t._v("订单内容：")]),e("div",{staticClass:"item-value"},[t._v(t._s(t.payInfo.pay_detail))])]),e("div",{staticClass:"order-item"},[e("div",{staticClass:"item-label"},[t._v("订单金额：")]),e("div",{staticClass:"item-value"},[t._v("￥"+t._s(t.payInfo.pay_money))])]),e("div",{staticClass:"order-item"},[e("div",{staticClass:"item-label"},[t._v("创建时间：")]),e("div",{staticClass:"item-value"},[t._v(t._s(t.$timeStampTurnTime(t.payInfo.create_time)))])])])],1)],1):t._e()])]),e("div",{staticClass:"item-block"},[e("div",{staticClass:"block-text"},[t._v("支付方式")]),e("div",{staticClass:"pay-type-list"},[t._l(t.payTypeList,(function(a,i){return e("div",{key:i,staticClass:"pay-type-item",class:t.payIndex==i?"active":"",on:{click:function(a){t.payIndex=i}}},[t._v(" "+t._s(a.name)+" ")])})),e("div",{staticClass:"clear"})],2)]),e("div",{staticClass:"item-block"},[e("div",{staticClass:"order-submit"},[e("el-button",{staticClass:"el-button--primary",attrs:{type:"primary"},on:{click:t.pay}},[t._v("立即支付")])],1),e("div",{staticClass:"clear"})]),e("el-dialog",{staticClass:"confirm-pay-wrap",attrs:{title:"请确认支付是否完成",visible:t.dialogVisible,width:"23%",top:"30vh"},on:{"update:visible":function(a){t.dialogVisible=a}}},[e("div",{staticClass:"info-wrap"},[e("i",{staticClass:"el-message-box__status el-icon-warning"}),e("span",[t._v("完成支付前请根据您的情况点击下面的按钮")])]),e("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[e("el-button",{attrs:{size:"small"},on:{click:t.goIndex}},[t._v("返回首页")]),e("el-button",{attrs:{type:"primary",size:"small"},on:{click:t.goOrderList}},[t._v("已完成支付")])],1)]),e("el-dialog",{attrs:{title:"请用微信扫码支付",visible:t.openQrcode,width:"300px",center:""},on:{"update:visible":function(a){t.openQrcode=a}}},[e("div",{staticClass:"wechatpay-box"},[e("img",{attrs:{src:t.payQrcode}})])])],1)},s=[],n=(e("4160"),e("c975"),e("a434"),e("159b"),e("3e0f")),o={name:"pay",components:{},data:function(){return{orderOpen:!1,outTradeNo:"",payInfo:{pay_money:0},payIndex:0,payTypeList:[{name:"支付宝支付",icon:"iconzhifubaozhifu-",type:"alipay"},{name:"微信支付",icon:"iconweixinzhifu",type:"wechatpay"}],payUrl:"",timer:null,payQrcode:"",openQrcode:!1,loading:!0,test:null,dialogVisible:!1}},created:function(){this.$route.query.code?(this.outTradeNo=this.$route.query.code,this.getPayInfo(),this.getPayType(),this.checkPayStatus()):this.$router.push({path:"/"})},methods:{getPayInfo:function(){var t=this;Object(n["b"])({out_trade_no:this.outTradeNo,forceLogin:!0}).then((function(a){a.code,a.message;var e=a.data;e&&(t.payInfo=a.data),t.loading=!1})).catch((function(a){t.loading=!1,t.$message.error({message:a.message,duration:2e3,onClose:function(){t.$router.push({path:"/member/order_list"})}})}))},getPayType:function(){var t=this;Object(n["c"])({}).then((function(a){var e=a.code;a.message,a.data;e>=0&&t.payTypeList.forEach((function(e,i){-1==a.data.pay_type.indexOf(e.type)&&t.payTypeList.splice(i,1)}))})).catch((function(a){t.$message.error(a.message)}))},checkPayStatus:function(){var t=this;this.timer=setInterval((function(){Object(n["a"])({out_trade_no:t.outTradeNo}).then((function(a){var e=a.code,i=(a.message,a.data);e>=0&&(0==e?2==i.pay_status&&(clearInterval(t.timer),t.dialogVisible=!1,t.$router.push({path:"/result?code="+t.payInfo.out_trade_no})):clearInterval(t.timer))})).catch((function(a){clearInterval(t.timer),t.$router.push({path:"/"})}))}),1e3)},pay:function(){var t=this,a=this.payTypeList[this.payIndex];if(a){if("alipay"==a.type)var e=window.open();Object(n["d"])({out_trade_no:this.payInfo.out_trade_no,pay_type:a.type,app_type:"pc"}).then((function(i){var s=i.code,n=i.message;i.data;if(s>=0)switch(a.type){case"alipay":t.payUrl=i.data.data,e.location.href=t.payUrl,t.open();break;case"wechatpay":t.payQrcode=i.data.qrcode,t.openQrcode=!0;break}else t.$message({message:n,type:"warning"})})).catch((function(a){t.$message.error(a.message)}))}},open:function(){this.dialogVisible=!0},goIndex:function(){clearInterval(this.timer),this.dialogVisible=!1,this.$router.push({path:"/"})},goOrderList:function(){clearInterval(this.timer),this.dialogVisible=!1,this.$router.push({path:"/member/order_list"})}}},r=o,c=(e("e714"),e("7f03"),e("2877")),l=Object(c["a"])(r,i,s,!1,null,"69547172",null);a["default"]=l.exports},"7f03":function(t,a,e){"use strict";var i=e("cb91"),s=e.n(i);s.a},cb91:function(t,a,e){},e3df:function(t,a,e){},e714:function(t,a,e){"use strict";var i=e("e3df"),s=e.n(i);s.a}}]);
//# sourceMappingURL=chunk-4e084ad9.f1ecf013.js.map